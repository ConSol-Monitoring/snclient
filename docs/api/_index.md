---
title: REST API
linkTitle: REST API
---

SNClient comes with a REST API which can be used to run checks or do administrative tasks.

For the sake of completeness the list of endpoints also contains the available none-rest URLs.

## Endpoints

These endpoints are available if the `WEBServer` is enabled in the modules section.

### /

Redirects to `/index.html`

### /index.html

Returns simple OK message:

Example:

```bash
curl \
    -u user:changeme \
    -X POST \
    https://127.0.0.1:8443/index.html
```

Returns:

```text
snclient working...
```

## Checks Endpoints

These endpoints are available if the `WEBServer` is enabled in the modules section.

### /query/{command}

Legacy check command endpoint.

Example:

```bash
curl \
    -u user:changeme \
    -X POST \
    https://127.0.0.1:8443/query/check_uptime
```

### /api/v1/queries/{command}/commands/execute

Version 1 check command endpoint.

Example:

```bash
curl \
    -u user:changeme \
    -X POST \
    https://127.0.0.1:8443/api/v1/queries/check_uptime/commands/execute
```

### /api/v1/inventory

Returns the check inventory as json

Example:

```bash
curl \
    -u user:changeme \
    -X POST \
    https://127.0.0.1:8443/api/v1/inventory
```

Returns:

```json
{
    "inventory": {
        "cpu": [
            {
                "core": "core1",
                "core_id": "core1",
                "load": "43",
                "time": "5m"
            },
            ...
        ],
        ...
        "temperature": [
            {
                "crit": "100.000000",
                "label": "Core 1",
                "max": "100.000000",
                "min": "0.000000",
                "name": "coretemp",
                "path": "/sys/class/hwmon/hwmon5/temp3_input",
                "temperature": "44.000000"
            }
        ],
        "uptime": [
            {
                "boot": "2023-12-04 07:16:01",
                "uptime": "8d 09:07h",
                "uptime_value": "724072.8"
            }
        ]
    },
    "localtime": 1702398235
}
```

### /api/v1/inventory/{module}

Returns the check inventory for a specific modules json. Available modules
are the keys from the inventory hash map as returned from `/api/v1/inventory`.

Example:

```bash
curl \
    -u user:changeme \
    -X POST \
    https://127.0.0.1:8443/api/v1/inventory/memory
```

## Prometheus Endpoints

These endpoints are available if the `PrometheusServer` is enabled in the modules section.

### /metrics

Returns prometheus metics for snclient itself.

## Node Exporter Endpoints

These endpoints are available if the `NodeExporterServer` or `WindowsExporterServer` is enabled in the modules section.

### /node/metrics

Used by the [WindowsExporter](../prometheus/windows/) and [NodeExporter](../prometheus/node/).

Returns prometheus metrics from those exporters.

## Exporter Exporter Endpoints

These endpoints are available if the `ExporterExporterServer` is enabled in the modules section.

### /list

Used by the [ExporterExporter](../prometheus/exporter/) server.

Returns list of exporters.

### /proxy

Used by the [ExporterExporter](../prometheus/exporter/) server.

Returns metrics for given exporter.

## Administrative Endpoints

These endpoints are available if the `WEBAdminServer` is enabled in the modules section.

It is best practice to use a separate password for the administrative tasks, for example:

```ini
[/settings/WEBAdmin/server]
password = mysecretadminpassword
```

### /api/v1/admin/reload

Reload the configuration.

Example:

```bash
curl \
    -u user:changeme \
    -X POST \
    https://127.0.0.1:8443/api/v1/admin/reload
```

Returns

```json
{"success":true}
```

### /api/v1/admin/certs/replace

Replace the TLS certificate and key on the fly. Reload is optional.

The certificates need to be base64 encoded as in the following example.

When updating the TLS certificate with a new certificate obtained by requesting a Certificate Signing Request (CSR) from
the CSR endpoint, the keydata field must be omitted. The certificate will only be updated if the public key associated
with the new certificate matches the public key generated by the CSR endpoint.

Example:

```bash
curl \
    -u user:changeme \
    -d '{ "certdata": "'$(base64 -w 0 ./server.crt)'", "keydata": "'$(base64 -w 0 dist/server.key)'", "reload": true }' \
    https://127.0.0.1:8443/api/v1/admin/certs/replace
```

Returns

```json
{"success":true}
```

### /api/v1/admin/csr

Request a new csr, creates new private key if requested by the user or uses the already existing one.
The only field that needs to be set is `CommonName` the rest of the fields is optional.

Optionally you can also set a `ChallengePassword` in the csr request.

Example:

```bash
curl \
    -u user:changeme \
    -d '{"Country":"DE","State":"Bavaria","Locality":"Earth","Organization":"snclient","OrganizationalUnit":"IT","HostName":"Root CA SNClient", "NewKey":true, "KeyLength":4096}' \
    https://127.0.0.1:8443/api/v1/admin/csr
```

Returns PEM encoded csr
When NewKey:true is specified, a new private key will be generated and stored in a temporary file. This temporary file
will be retained until you upload the signed certificate to the /api/v1/admin/certs/replace endpoint, at which point the
new private key will be saved in the keyfile specified in the configuration

### /api/v1/admin/updates/install

Trigger checking for updates.

Example:

```bash
curl \
    -u user:changeme \
    -X POST \
    https://127.0.0.1:8443/api/v1/admin/updates/install
```

Returns

```json
{
    "success":  true,
    "message": "update found and installed",
    "version": "v0.27.0024"
}
```
